Grigory Kislin [12:50 AM]
joined #hw6.

Grigory Kislin [12:54 AM]
Добро пожаловать: https://github.com/JavaWebinar/topjava/blob/doc/doc/lesson06.md
Начинаем изучать Spring-MVC и слой Web. 
Домашнее задание относительно большие, следующее занятие будет 16.08 по расписанию: https://github.com/JavaWebinar/topjava/
Подтягиваем "хвосты" +  если справились раньше - делаем выпускной проект (edited)

Victor [12:56 AM]
joined #hw6 along with 15 others.


Gagarina6794 [Aug 2nd at 6:38 AM]
Всем привет)  Для IDEA в spring-db.xml не забудьте выставить Spring Profiles: например datajpa, postgres - Никак не пойму зачем нам помнить выставлять в xml профиля, разве только для визуально удобства, если не один не выбирать, автоматом все светятся, если только выборочно, и запускать тесты, то тесты все-равно задействуют все профиля которые им прямо прописаны, потому и используем резолвер для postgres и hqldb


3 replies
Yevhen Maksymovych [1 day ago]
Для визуального удобства, и для интеграции с идеей, чтобы по клику прогуляться в инжектируемый класс из текущего профиля



Yevhen Maksymovych [1 day ago]
Ну и чтобы идея не ругалась на несколько реализаций одного типа бина


e.pekhterev [1 day ago]
у меня ничего не ругалось, на переключение забил, но помнил, что оно есть. жаль, что эту штуку нельзя автоматизировать. (edited)


Aleksey Vra [6:46 AM]
joined #hw6 along with 2 others.


Kirilo [Aug 2nd at 7:45 AM]
Смотрел видео по разбору Optional предыдущего урока, где мы используем метод по умолчанию в интерфейсе и словил себя на мысли, что после 8-ой Java по сути сняты фундаментальные ограничения языка по множественному наследованию, единственное, что делать это придется через интерфейсы.


15 replies
tema.emelyan [1 day ago]
не скомпилируется



Kirilo [1 day ago]
Это если default методы будут иметь одинаковое название.
https://docs.oracle.com/javase/tutorial/java/IandI/multipleinheritance.html (edited)


shtramak [1 day ago]
В этой ссылке все подробно расписано https://www.linkedin.com/pulse/multiple-inheritance-interfaces-java-9-classic-diamond-katkuri (edited)


tema.emelyan [1 day ago]
@Kirilo разные названия можно само собой начиная с первой джавы


Victor [1 day ago]
это не класс, это контракт. Интерфейс не может хранить состояния. Дефолт методы тут ничего не изменили.
Если нужно сделать множественное наследование, можно сделать внутренний класс, и унаследовать его от другого класса, нежели основной.



Kirilo [1 day ago]
@tema.emelyan дефолтных методов в интерфейсах? Ну-ну.


tema.emelyan [1 day ago]
@Kirilo ок, давай разбираться. что ты понимаешь под множественным наследованием?

Kirilo [1 day ago]
Да то, что мы наследуем методы с раных класов. Конечно, поля в интерфейс не запишешь.


tema.emelyan [1 day ago]
ну ты говоришь вот с 8ой джавы теперь всё что угодно можно. вот это конкретно что значит? как здесь множественное наслед-ие появилось?

Kirilo [1 day ago]
Именно, потому что раньше можно было только один клас наследовать и множество интерфейсов, у которых никаких методов не было


tema.emelyan [1 day ago]
это не множественное наследование, это то же самое, что в первой джаве унаследоваться от нескольких интерфейсов и все эти интерфейсы имплементировать


Kirilo [1 day ago]
Эти методы можно использовать как есть. А то просто контракт для обязательной реализации. (edited)


tema.emelyan [1 day ago]
реализация по умолчанию появилась - да. в этой реализации по умолчанию ничего не известно об объекте то есть она тоже основана на контракте. в плане множественного наследования ничего не поменялось. множественное наследование интерфейсов было раньше.


Kirilo [1 day ago]
Интерфейсов было, но теперь появилась возможность наследовать фенкционал! Что было чуть ли не главным отличием интерфейса от класса! (edited)


Grigory Kislin [1 day ago]
отличие интерфейсов от абстрактных классов- нельзя делать члены класса (не статические) и конструкторы... в остальном- да:) (edited)


Stanislav [Aug 2nd at 9:45 AM]
Так и не понял для чего аннотация @SuppressWarnings  (убирает предупреждения компилятора), стоит в CrudMealRepository над getBetween выключает предупреждения JpaQlInspection. Без этой аннотации не заметил ни каких предупреждений (не в idea, ни при рантайме).


15 replies
shtramak [1 day ago]
подчеркивает у многих красным. Может что-то обновилось недавно, но я сам видел этот глюк


Stanislav [1 day ago]
Странно, убирал эту аннотацию и полностью почистил maven - idea кэш, ни чего не подчеркивается


shtramak [1 day ago]
вполне возмножно, что исправили ¯\_(ツ)_/¯


Yevhen Maksymovych [1 day ago]
у меня в последнем билде не исправлено

Yevhen Maksymovych [1 day ago]
без подавления


Yevhen Maksymovych [1 day ago]
Pasted image at 2018-08-02, 10:31 AM



Yevhen Maksymovych [1 day ago]
с подавлением


Yevhen Maksymovych [1 day ago]
Pasted image at 2018-08-02, 10:31 AM



Yevhen Maksymovych [1 day ago]
если кто-то подскажет, как это поправить без подавления, буду признателен :slightly_smiling_face:


Join_Selectovich [1 day ago]
перфекционист :wink: (edited)

Gagarina6794 [1 day ago]
Аннотация маскирует красные подчеркивания, пиши в квери хоть стихи, оно ничего не скажет, как на меня то не совсем полезная вещь, будешь потом долгого искать где ошибка, если поставить такое и начать писать запрос, эту фичу надо осторожно использовать, только на готовом и перепроверенном запросе


Yevhen Maksymovych [1 day ago]
ну я о том и говорю, если кто-то подскажет, как заставить понимать идею обновленный синтаксис jpql (с поддержкой операторов between, like и тп), то буду признателен :slightly_smiling_face:


Yevhen Maksymovych [1 day ago]
а то за что я плачу 130 баксов в год? чтобы меня подчёркивалии? ))



Gagarina6794 [1 day ago]
Вот эта аннотация я считаю вредная, нельзя так с потребителями)


Grigory Kislin [1 day ago]
похоже что уши старой idea. уберу, спасибо (edited)


Jury Mironov [Aug 2nd at 10:23 AM]
После двух патчей по дз HW5 - Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'ru.javawebinar.topjava.repository.MealRepository' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {} (edited)


3 replies
Jury Mironov [1 day ago]
Это при деплое через томкат и выборе списка meal юзеров, так и должно быть?


Михаил [6 hours ago]
Maven Re-Import ты делаешь по необходимости? (edited)


Михаил [6 hours ago]
Pasted image at 2018-08-03, 7:39 PM


Jury Mironov [Aug 2nd at 11:12 AM]
У меня опять конфликты при применении патчей . Я уже не знаю что делать с этим. Постоянно проблемы (edited)


17 replies
e.pekhterev [1 day ago]
я пока только первый накатил, пока норм


Stanislav [1 day ago]
@Jury Mironov ты после каждого патча пробуешь выполнить тесты-сервлет?


Jury Mironov [1 day ago]
После дз. Но конфликты же не связаны с тестами


Stanislav [1 day ago]
хз, ни разу не было конфликтов


Jury Mironov [1 day ago]
у меня на кажом уроке конфликты


e.pekhterev [1 day ago]
@Jury Mironov тебе похоже надо с *stea1th* подружиться))



e.pekhterev [1 day ago]
у меня было только раз, но и то из-за того, что не прочитал инструкции в задании

Grigory Kislin [1 day ago]
@Jury Mironov учиться работать с git. на работе будет уже сложнее. еще почитай внимательно https://github.com/JavaOPs/topjava/wiki/git


Merkulov [1 day ago]
может ты работаешь на нескольких машинах и иногда делаешь update не той ветки)


Merkulov [1 day ago]
ну или забываешь

Merkulov [1 day ago]
и соответственно при накатки патчей будет конфликт

Ignat [1 day ago]
Потрать пару часов на https://learngitbranching.js.org/ Там уроки с визуализацией
learngitbranching.js.org
Learn Git Branching
An interactive Git visualization tool to educate and challenge! (71 kB)
 


stea1th [1 day ago]
а чо сразу я? :slightly_smiling_face:


Jury Mironov [8 hours ago]
Да,  работаю на нескольких машинах,  но я всегда в одной ветке.  До дз я дойти не успеваю. Пока поправлю все ошибки,  пока разберусь,  что происходит вообще...Причем бывает,  что на одном устройстве норм все, а на другом хрень


Jury Mironov [8 hours ago]
да,  кстати,  а почему Вы?)

e.pekhterev [8 hours ago]
потому как насколько помню только у вас двоих тут проблемы с накаткой патчей

Joanna [43 minutes ago]
в одной ветке master....о_0? попробуй присмотреться внимательно, что ты коммитишь и пушишь. Если предыдущий патч неправильно наложен или не наложен(можно и завтыкать), то потом не все гладко. Следи, что тут подтягивается VCS -> Commit -> ChangeList


alexey [Aug 2nd at 12:12 PM]
Народ может кто нибудь объяснить зачем мы подключаем Хибернэйтовский кэш если у на уже есть один?!


5 replies
Yevhen Maksymovych [1 day ago]
это чуть разные кэши. спринговый кэш - это кэш объектов нашей программы, он по сути не имеет никакой связи с БД, там могут лежать какие-нибудь дто из бизнеса. хибернейтовский кэш - это уже кэш персистированных объектов, с которым работает репозиторий, т.е. более низкого уровня



Yevhen Maksymovych [1 day ago]
т.е. кэш хибернейта по сути сидит где-то в районе энтитименеджера первой стеной между твоей программой и бд. а кэш спринга можно в принципе повесить куда угодно, но только там, где уже существуют объекты, т.е. на дао, и выше.


alexey [1 day ago]
т.е. спринговому кэшу нужен объект и ему пофиг откуда он?


Yevhen Maksymovych [1 day ago]
да, ты можешь просто генерить объекты, без хибернейта вообще, и складывать их в спринговый кэш


alexey [1 day ago]
понял. спасибо:+1:


alexey [1:39 PM]
Народ кто нибудь сталкивался с таким варнингом? Что за favicon.ico и как его убрать?
favicon? 
No mapping found for HTTP request with URI [/topjava/favicon.ico] in DispatcherServlet with name 'mvc-dispatcher'

Yevhen Maksymovych [1:40 PM]
положить его в статические ресурсы

alexey [1:42 PM]
откуда я его должен взять?

Yevhen Maksymovych [1:42 PM]
да любой скачай
можно даже с бэтменом


Yevhen Maksymovych [Yesterday at 1:43 PM]
это просто иконка для сайта, которая будет отображаться в закладках и заголовке браузера


2 replies
alexey [12 hours ago]
а почему он ее стал требовать? мы это где то указывали или это идет дефолтом при подключении spring mvc?


Ignat [12 hours ago]
её браузер запрашивает, а в логах тебе сказали, что кто-то хочет `/topjava/favicon.ico`, а диспетчер о таком первый раз слышит (edited)


Victor [Yesterday at 3:27 PM]
темы такие как `8. Конфигурирование Tomcat через maven plugin. Jndi-lookup.` вызывают у меня нервное напряжение. Видео для меня звучит так: послушал много разных слов, 15% уловил, остальное - космос.
Мой вывод такой: скопируй настройки, такие как сделал Григорий, чтобы работать, и иди дальше.


2 replies
Join_Selectovich [7 hours ago]
Знакомые чувства. Потом когда пару дней посидишь,  раз 10 видео это переcмотришь,  потом пытаешся вникнуть в суть материала кучи ссылок, начинаешь улавливать 16.5%, потом опять та же итерация. Дальше, когда ДЗ сделаешь кое-как, еще немного процентов добавляется.. (edited)


Grigory Kislin [3 hours ago]
попробуй вопросы сформулировать (edited)


sky [5:29 PM]
Итак, задание 1.1 Починить тесты InMemoryAdminRestControllerSpringTest/InMemoryAdminRestControllerTest (в новой версии Spring классы spring-mvc требуют WebApplicationContext, поэтому поправьте mock.xml)

Тесты сломались, так как мы кое что убрали из spring-app.xml. 
При чем тут тогда вот это - (в новой версии Spring классы spring-mvc требуют WebApplicationContext)?


Kirilo [Yesterday at 6:36 PM]
Интересно, каким образом hibernate валидатор создает interpolatedMessage, выводя сообщение на языке ОС?


2 replies
vch [7 hours ago]
Очевидно, что у него где-то хранятся языковые файлы с сообщениями.


Grigory Kislin [3 hours ago]
у него внутри есть файлы пропертей. можешь поискать. где-то в занятии будет вопрос


zippospb [12:21 AM]
Скажите, у всех при загрузке страницы /meals нормально подхватывается style.css? у меня его на /users и /index видит великолепно, а вот в /meals - никак. И root в RootController тоже не отрабатывал пока в GetMapping не поставил "/index"


Grigory Kislin [12 hours ago]
кэш обновлял? Ctrl+f5 для хром


zippospb [11 hours ago]
да


Grigory Kislin [8 hours ago]
посмотри вкладку Network в браузере


Daniel [5 hours ago]
@zippospb зайди в meals.jsp, в хедере поменяй ссылку на стиль на *resources/css/style.css*. У меня заработало. (edited)


e.pekhterev [Today at 2:36 PM]
@Grigory Kislin в *JpaUtil* равноценны ли будут две реализации?
>public void clear2ndLevelHibernateCache() {
>        Session s = (Session) em.getDelegate();
>        SessionFactory sf = s.getSessionFactory();
>        sf.getCache().evictAllRegions();
>}
и
>public void clear2ndLevelHibernateCache() {
>        em.getEntityManagerFactory().getCache().evictAll();
>}


И в первом, и во втором случае работаем с кэшем второгу уровня (в первом - с org.hibernate.Cache extends javax.persistence.Cache, а во втором - с его папкой javax.persistence.Cache). (edited)


2 replies
Grigory Kislin [8 hours ago]
не знаю. дебажил?


e.pekhterev [6 hours ago]
Разобрались:
evictAll - Hibernate impl - we only evict entity data here in keeping with the JPA intent (JPA only defines caching for entity data).  For evicting all cache regions (collections, natural-ids and query results), use evictAllRegions() instead. (edited)


zippospb [Today at 3:23 PM]
Вот блин. сначала сделал MealController полностью на аннотациях, а теперь вчитался в задание и придется переделывать на костыльный вариант с HttpServletRequest ))))



1 reply
Grigory Kislin [8 hours ago]
раз сделал- оставь


Victor [3:40 PM]
replied to a thread:

@Grigory Kislin по факту мы выносим настройки. в  context.xml вместо использования .properties файла. Для этого нужно добавлять плагин, как-то по особому его настраивать, подключать урезанный .properties файл (!), понимать что да как с контекстом происходит, деплоить по особому. И все это ради, того чтобы занести настройки  базы в контекст во время для development'а. 
Какая польза для меня как разработчика, в таком усложнении. Сложно = больше вероятность ошибки. Можно сделать проще - нужно делать проще. Или мы уже все в девопсы должны морально готовиться? :slightly_smiling_face:

Victor [8:38 PM]
Теория, в видео с 3:30 о контекстах, мне кажется, расходится с той, что в доках.
1. Исходя из скрина, даже если бин занесен в два контекста, конфликта не будет. Потому что делегирование идет только если бин не найдет.
2. WebAppContext тоже один, но при желании его можно шарить с другими DispatcherServlet, но по разному конфигурировать.
> For many applications having a single WebApplicationContext is simple and sufficient. It is also possible to have a context hierarchy where one root WebApplicationContext is shared across multiple DispatcherServlet (or other Servlet) instances, each with its own child WebApplicationContext configuration.
2018-08-04_20-01-31.png 


Yevhen Maksymovych [3 hours ago]
делегирование идёт, если бин не найден, но повторная инициализция бина может привести к нежелаемым последствиям :slightly_smiling_face:



Yevhen Maksymovych [3 hours ago]
вдруг у него в при поднятии есть какая-то логика, которая происходит в посткриэйте, и закрывается в предестрое. а так мы ее вызовем дважды подряд


Victor [3 hours ago]
понял, то есть сам факт поднятия двух одинаковых синглтон бинов может вызвать проблемы. Даже если мы к бину из root не будем обращаться. (edited)


Grigory Kislin [1 hour ago]
нуда. с ними и сталкивался. в отличии от нескольких DispatcherServlet - ни разу не встречал, думаю что-то редкое. но спасибо за информацию


Kirilo [4:00 PM]
Прикольно. Запустил приложение через плагин с консоли. Работает, правда версия у нас уже другая, чем в лекции, и пришлось в папку проекта становиться. (edited)

sky [5:37 PM]
Возможно ли выполнить последнее задание в 1 запрос c JOIN, с помощью BeanPropertyRowMapper, или это я делаю что-то не так? Не так -  это просто через RowMapper например.. (edited)


svis [Yesterday at 11:35 PM]
2.2 Добавить еще одну роль к ADMIN (будет 2 роли: ROLE_USER, ROLE_ADMIN)  - непонятно, что имеется ввиду. У нас и так две роли, а если к роли Admin добавить еще одну роль то будет три роли :face_with_rolling_eyes: Или это просто надо добавить еще одного админа в тестовых данных? (edited)


4 replies
zippospb [13 hours ago]
так это же к пользователю с именем Admin надо добавить новую роль, тобишь ROLE_USER


Victor [13 hours ago]
там set ролей, юзер может выполнять несколько ролей. Как я понял, нужно в set юзера по имени "Admin" добавить две роли.


svis [13 hours ago]
Ну то есть один юзер по имени ADMIN будет в двух ролях


svis [13 hours ago]
ок, тогда понятно


Kirilo [10:07 AM]
Локализация как-то коряво работает. У меня в браузере русский на втором, английский на третьем. Но все равно русский не покажет, пока его на первый не перетащишь. Использую Firefox. Скачивал chrome специально, чтобы проверить - та же ерунда.


Yevhen Maksymovych [Today at 11:32 AM]
а анотация @BatchSize как-то кореллирует с опцией hibernate.jdbc.batch_size?


2 replies
Grigory Kislin [2 hours ago]
да, полагаю что hibernate.jdbc.batch_size выставляется сразу для всего приложения


Yevhen Maksymovych [2 hours ago]
спасибо!


Crazz [12:58 PM]
кто как поборол - meal форма `<form method="post" action="/meals/create">`, контроллер ждет `@GetMapping("/meals/create")` и `@PostMapping("/meals/create")` и пост почему то не ловится. Если же action поставить `""`, то пост ловится. Но `update/{id}` будет кидать post по этому же адресу, второй метод для update писать? а обьединить пути которые маппятся в одной аннотации можно? (edited)

Yevhen Maksymovych [1:04 PM]
тебе не обязательно вешать один метод на одну урлу. ты можешь перечислить урлы, на которые мапится метод просто массивом в аннотации

Crazz [1:10 PM]
точно, спасибо


turhanow [Today at 8:41 PM]
всем привет! это только у меня после накатки всех патчей томкат зависает с таким исключением?
Untitled
Caused by: org.hibernate.service.spi.ServiceException: Unable to create requested service [org.hibernate.engine.jdbc.env.spi.JdbcEnvironment]
  ... 88 more
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:275)
Caused by: java.lang.ClassNotFoundException: org.postgresql.Driver
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:237)
  at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1285)
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:214)
  at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1119)
  at org.hibernate.id.factory.internal.DefaultIdentifierGeneratorFactory.injectServices(DefaultIdentifierGeneratorFactory.java:152)
  at java.lang.Class.forName0(Native Method)
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.injectDependencies(AbstractServiceRegistryImpl.java:286)
  at java.lang.Class.forName(Class.java:348)
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:243)
  at org.apache.tomcat.jdbc.pool.ClassLoaderUtil.loadClass(ClassLoaderUtil.java:38)
  at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:214)
  ... 89 more
  at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:179)
  at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:119)
06-Aug-2018 20:38:09.578 INFO [localhost-startStop-1] org.apache.jasper.servlet.TldScanner.scanJars At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
  at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:904)
06-Aug-2018 20:38:09.596 SEVERE [RMI TCP Connection(3)-127.0.0.1] org.apache.catalina.core.StandardContext.startInternal One or more listeners failed to start. Full details will be found in the appropriate container log file
  at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:935)
06-Aug-2018 20:38:09.597 SEVERE [RMI TCP Connection(3)-127.0.0.1] org.apache.catalina.core.StandardContext.startInternal Context [/topjava] startup failed due to previous errors
Collapse


8 replies
Victor [3 hours ago]
вот это проверял? Caused by: java.lang.ClassNotFoundException: org.postgresql.Driver


turhanow [3 hours ago]
в мавен я не менял ничего, у меня там вот это:
<dependency>
                <groupId>org.postgresql</groupId>
                   <artifactId>postgresql</artifactId>
                   <version>${postgresql.version}</version>
               </dependency>


turhanow [3 hours ago]
а вот на стековерфлоу пишут что мол надо скачать библиотеку https://stackoverflow.com/questions/38410850/hibernate-postgresql-driver-issue/38411466#38411466
Stack Overflow
Hibernate: PostgreSQL Driver issue
I know that there are similar questions already, but the answers there didn't help me. So please would you mind to take a look at my particular question? I am not very experienced with Hibernate y...
 


turhanow [3 hours ago]
но что то мне подсказывает что никто в группе этим не занимался, видимо ошибка в другом..


turhanow [2 hours ago]
проблему решил скачав из мавен репозитория драйвер постгрис и положил его в lib tomcat.
но насколько это правильно...


Andrew Kuzin [2 hours ago]
вроде бы у меня была такая ошибка. но я избавился сменой профиля + немного перенастроил адрес, пароль и логин постгреса т.к. постгрес у меня был настроенный до этого курса


turhanow [1 hour ago]
> я избавился сменой профиля + немного перенастроил адрес


вот здесь поподробнее плиз


Andrew Kuzin [32 minutes ago]
ну есть файл postgres.properties, там параметры подключения к постгресу. котрые мне лично приходится менять) хотя помоему это не ваш случай.


Jury Mironov [Today at 10:33 PM]
P_20180806_223147.jpg



2 replies
Ignat [1 hour ago]
Сверху Query закомментируй


Jury Mironov [1 hour ago]
спасибо


turhanow [Today at 9:23 AM]
Хей гайс, у кого все найс с MVC?:slightly_smiling_face:
я никак не могу понять вот что. У нас в RootController есть:
`
@GetMapping("/users")
   public String users(Model model) {
       model.addAttribute("users", service.getAll());
       return "users";
   }
`
из метода видно что мы возвращаем стрингу. Теоретически я догадываюсь, что возвращаем то мы не совсем стрингу, а модель с атрибутом users, но object==String (!). И вот здесь у меня в голове засада, как jsp понимает что ему  с бэкенда возвратилась по факту коллекция, которую нужно отобразить в таблице юзеров??? (edited)


19 replies
Alexander Pilipenko [14 hours ago]
Возвращаем мы совсем стрингу return "users";

Alexander Pilipenko [14 hours ago]
В атрибуты заносим пользователей через model.addAttribute("users", service.getAll());


turhanow [14 hours ago]
Саш...а как модель с атрибутами попадает в JSP... я вот где то в уроке есть ссылка про это почитать? может я пропустил


turhanow [14 hours ago]
и почему м именно стринг возвращаем, на каком этапе именно этот тип данных нам требуется..


Alexander Pilipenko [14 hours ago]
Думаю что зедесь


Alexander Pilipenko [14 hours ago]
http://www.mkyong.com/spring-mvc/spring-mvc-hello-world-example/

Alexander Pilipenko [14 hours ago]
https://www.baeldung.com/spring-mvc-model-model-map-model-view
Baeldung
Model, ModelMap and ModelView in Spring MVC | Baeldung
Learn about the interfaces Model, ModelMap and ModelView provided by Spring MVC.
Oct 17th, 2017 at 4:54 PM
 


Alexander Pilipenko [14 hours ago]
https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#mvc-ann-arguments


Alexander Pilipenko [14 hours ago]
String

A view name to be resolved with ViewResolver's and used together with the implicit model — determined through command objects and @ModelAttribute methods. The handler method may also programmatically enrich the model by declaring a Model argument (see above).


shtramak [13 hours ago]
return "users" означает вернуть jsp, в имени которой есть users. ViewResolver внутри добавить префикс и суффикс, который ему прописали. Это может быть даже view/users.jsp , это уж как душе угодно.


shtramak [13 hours ago]
а атрибут "users" и return "users" между собой никак не связаны

turhanow [13 hours ago]
> return "users" означает вернуть jsp, в имени которой есть users
вот за это от души спасибо! я то думал мы возвращаем аттрибут с именем users, а оказывается jsp


turhanow [13 hours ago]
@GetMapping("/users")
  public String users(Model model) {
      model.addAttribute("users", service.getAll());
      *return "users_page";*
  }
если бы названия в проекте немного различали, было бы удобнее разобраться.. (edited)


shtramak [13 hours ago]
:+1:


Yevhen Maksymovych [13 hours ago]
фактически, надо понимать, что хотя мы возвращаем только имя вида, с ним незримо гоняется модель :slightly_smiling_face:



Kirilo [7 hours ago]
При помощи интерфейса ViewResolver DispatcherServlet определяет, какой Вид нужно использовать на основании полученного имени.

Kirilo [7 hours ago]
В Spring web MVC вся работа происходит через DispatcherServlet. Так по имени выбирается нужный файл. https://www.tutorialspoint.com/spring/images/spring_dispatcherservlet.png (27 kB)


Alexander Pilipenko [5 hours ago]
и в видео про это рассказывается


Alexander Pilipenko [5 hours ago]
https://drive.google.com/open?id=0B9Ye2auQ_NsFQThUX2VyQXNiTHM


Maksim K [2:32 PM]
Хеллоу, парни и девушки!) Я снова с вами. То есть наконец-то перешел на 6 левел) И сразу вопросики) По вот этому:
`Apply 6_01_HW5_data_jpa.patch В get получаем и фильтруем Optional<User>`
Я так понимаю здесь описка и имеется ввиду `Optional<Meal>`. Или я что-то не так понимаю?)
И еще, а почему в реализации дз Григорий не использовал "уличную" магию с выводом запросов из названия методов, а использовал @Query. В видео он говорит, что, мол, эта магия работает медленнее и сам же потом говорит, что эта скорость это все относительно. Думаю для нашего проекта это не критично в плане производительности (или нет?). Но зато в целях обучения, для наглядности было бы неплохо использовать эту самую магию)) (edited)


Stanislav [Today at 3:20 PM]
Не могу понять: почему
```redirect:/meals```
работает нормально, а
```redirect:meals```
конкатенирует (http://localhost:8080/topjava/meals/meals), а в RootController-е работает и так и так. (edited)


21 replies
shtramak [8 hours ago]
ну наверн над контроллером стоит @RequestMapping("/meals")? (edited)


Stanislav [8 hours ago]
да :slightly_smiling_face:


Stanislav [8 hours ago]
только до меня не доходит, почему он конкатенирует


shtramak [8 hours ago]
ну вот он и складывает, когда даешь путь относительный (без слеша в начале)


Stanislav [8 hours ago]
спасибо

Stanislav [8 hours ago]
вроде понял)


Stanislav [8 hours ago]
нет, раньше стояло @RequestMapping(value = "/meals") поставил @RequestMapping(value = "meals") все равно то же самое


shtramak [8 hours ago]
Хм, давай все сначала)


shtramak [8 hours ago]
У тебя стоит над контроллером маппинг? Он будет работать для всех методов в контроллере и для view, которые возвращаются как return "string";


shtramak [8 hours ago]
Те маппинги, которые стоят над методами, будут добавлять еще один уровень в урл

Stanislav [8 hours ago]
Все правильно, над JspMealController стоит @RequestMapping(value = "meals")


shtramak [8 hours ago]
а над методом что?


Stanislav [8 hours ago]
@GetMapping("/delete") который return "redirect:meals"


shtramak [8 hours ago]
вот суть в "redirect:meals" и "redirect:/meals"


shtramak [8 hours ago]
в первом случае слеша в начале нет, путь относительный. Он прибавит маппинг контроллера (как я понимаю)

Stanislav [8 hours ago]
В общем понял, тут то же самое что и в файловой системе, относительный-обсолютный

shtramak [8 hours ago]
я не хочу сам лишнего сказать)) Потому что у меня именно насчет redirect сомнения

shtramak [8 hours ago]
https://docs.spring.io/spring/docs/current/spring-framework-reference/web.html#mvc-redirecting-redirect-prefix

Stanislav [8 hours ago]
он убирает delete и ставит meals


shtramak [8 hours ago]
Здесь крохи написаны, по-подробнеее бы


Stanislav [8 hours ago]
все, спасибо


Mihail Kedel [Today at 5:06 PM]
request.getParameter  в сервлете это тоже самое что аннотация RequestParam в контролере?


1 reply
Kirilo [7 hours ago]
Да. Это спринговская обертка передает ссылки на сервлет таким образом


This message was deleted.


2 replies
Yevhen Maksymovych [7 hours ago]
в тестах же


Mihail Kedel [7 hours ago]
да уже нашёл,спасибо (edited)


Jury Mironov [Today at 5:47 PM]
Как переключать профили, чтобы бины. dataSource не были дублями?  Это в spring-db. xml


1 reply
Ma3stro [5 hours ago]
попробуй mvn clean


Jury Mironov [8 hours ago]
Не понятно как с этими профилями обращаться и переключаться


Ma3stro [6 hours ago]
@Jury Mironov профиль базы можно выбрать во вкладке maven'a, профиль репозитория в tomcat, web.xml и помнике. А для тестов аннотацией


Jury Mironov [5 hours ago]
А где в томкате это?


Ma3stro [4 hours ago]
VM options -Dspring.profiles.active=...


hav [Yesterday at 10:39 AM]
Помогите разобраться с ошибкой javax.servlet.jsp.JspTagException: No message found under code 'app.title' for locale 'ru_RU'


10 replies
alexey [13 hours ago]
а что конкретно не понятно? app.title есть у тебя в русской локали?


hav [13 hours ago]
файлы есть, app.title есть, но не видит


vch [13 hours ago]
переменная окружения точно создана?

hav [13 hours ago]
да


alexey [13 hours ago]
если остальные видит значит орфография


hav [13 hours ago]
для английской локали тоже не видит... Файлы не трогал, созданы патчем


alexey [13 hours ago]
остальные то видит?


hav [13 hours ago]
app.properties, app_ru.properties - не видит


tema.emelyan [13 hours ago]
переменная окружения не подтянулась скорее всего. Может попробуй её всунуть через IDE или перезагрузись?


hav [12 hours ago]
Все, разобрался. Прописывал в системе переменную, а она была прописана в конфиге запуска идеи, причем неправильно...


alexey [11:26 AM]
Получилось у кого нибудь настроить вывод запросов в базу для Jdbc????


Stanislav [Yesterday at 11:28 AM]
По какой причине после
 ```form method="post" action="meals/filter"``` 
и
 ```return "meals"``` 
адресная строка становится
 ```/topjava/meals/filter``` 
- это же не гет и не "redirect:/meals"


2 replies
Yevhen Maksymovych [13 hours ago]
"action" тебя фактически перебрасывает на этот урл, в контроллере ты возвращаешь вид без редиректа, соответственно, остаёшься на том урле, на котором ты попал в этот метод контроллера


Stanislav [13 hours ago]
ясно спс


Jury Mironov [Yesterday at 3:37 PM]
Could not resolve placeholder 'hibernate. format_sql'


1 reply
Jury Mironov [8 hours ago]
При запуске одного из тестов.  Это можно починить?  Не понимаю как с профилями разобраться


matrocob [Yesterday at 7:29 PM]
подскажите пожалуйста, после накатки всех патчей ошибка такая вылетает при запуске томката... Может я где-то, что-то не досмотрел?
HTTP Status 500 - An exception occurred processing JSP page /WEB-INF/jsp/index.jsp at line 6


5 replies
matrocob [5 hours ago]
а в консоли вылетает такая ошибка

Stacktrace:
    at org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:579)


matrocob [4 hours ago]
Снимок.JPG



hav [4 hours ago]
Смотри переменные окружения. у меня то же самое было.


hav [4 hours ago]
https://topjava14.slack.com/archives/CC0F4AC1W/p1533713945000057
Aleksandr Khromov
Помогите разобраться с ошибкой javax.servlet.jsp.JspTagException: No message found under code 'app.title' for locale 'ru_RU'
Thread in #hw6Yesterday at 10:39 AM


matrocob [4 hours ago]
спасибо, сейчас гляну


hav [Yesterday at 7:56 PM]
Подскажите по 1.2 Починить Jdbc тесты (валидацию исключить). Не могу разобраться. Тесты падают на подключении JpaUtil. Как сделать чтобы  JpaUtil игнорировалось в jdbc тестах?


30 replies
Stanislav [4 hours ago]
Сделать так, что бы JpaUtils (сброс кеша) поднимался-производился только для Jpa


Stanislav [4 hours ago]
Еще одну абстракцию сделай


Victor_D [4 hours ago]
ну или можно из бинов его убрать в нужной реализации


Stanislav [4 hours ago]
В какой реализации, он внедряется в AbstractServiceTest


hav [4 hours ago]
Я не пойму как сделать чтоб он не внедрялся в jdbc реализации...


Stanislav [4 hours ago]
Есть 2 пути: 1. То что предложил Victor, прописать JpaUtils (и для чего он используется) только в тех где он нужен (где используется хибернейт + кэш 2 ур.) - но это дублирование 4 класса


Stanislav [4 hours ago]
2. Сделать еще одну абстракцию


Stanislav [4 hours ago]
Как AbstractServiceTest


Victor_D [4 hours ago]
не обязательно дублировать в 4 класса


Stanislav [4 hours ago]
ой 2 класса, у нас в User только кэш (edited)


Stanislav [4 hours ago]
все равно дублирование


Victor_D [4 hours ago]
есть аннотация, у нее есть поле


Victor_D [4 hours ago]
т.е. с помощью нее можно заглушить бин


Stanislav [4 hours ago]
По профилю?


hav [4 hours ago]
как


Victor_D [4 hours ago]
не только по профилю

hav [4 hours ago]
Можно подробнее какая аннотация

hav [4 hours ago]
Пока у меня только вариант - перенести на уровень ниже, в реализации jpa и datajpa.


Victor_D [4 hours ago]
имеет право на жизнь, но не практично, @Stanislav говорил про абстрации, тебе в эту сторону двигаться :slightly_smiling_face:


Victor_D [4 hours ago]
если я правильно его понял


Stanislav [4 hours ago]
Правильно, только я не понимаю про какую аннотацию ты пишешь, самому интересно :slightly_smiling_face: (edited)


Victor_D [4 hours ago]
Autowired


Victor_D [4 hours ago]
она же бин подтягивает


Victor_D [4 hours ago]
и она не только на поле ставится


Stanislav [4 hours ago]
я понял через какое место :slightly_smiling_face:

hav [3 hours ago]
Спасибо за подсказки, сделал. Autowired на сеттер, переопределенный в jdbc реализации.

zippospb [3 hours ago]
В autowired ещё есть параметр,  который делает внедрение необязательным


hav [3 hours ago]
Да, required, только я не понял как его применить.


zippospb [2 hours ago]
Ставишь false и тогда туда инжект происходит только если это возможно



hav [2 hours ago]
Работает, и сеттер можно не переопределять
