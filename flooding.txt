Grigory Kislin [12:11 AM]
joined #flooding.

Grigory Kislin [12:11 AM]
set the channel purpose: оффтопик

Grigory Kislin [12:11 AM]
set the channel topic: оффтопик

Katherine [7:02 AM]
joined #flooding along with 10 others.

Vitaly [4:47 PM]
знатоки wildcard, хелп
`List<? extends Number> numbers = new ArrayList<>();`
и второй вариант:
`List<? super Number> numbers = new ArrayList<>();`
добавляем элементы:
` numbers.add(1);
  numbers.add(1L);
  numbers.add(1f);` (edited)
на варианте 1 - идея ругается, на 2 - все норм, хотя по логике - Integer ext Number, Double ext Number  и т.д.,  и уж никак не Integer super Number
в чем подвох?

shtramak [4:52 PM]
Загугли PECS
Producer - extends, consumer - super
https://youtu.be/_0c9Fd9FacU
YouTubeJUG .ru
Александр Маторин — Неочевидные Дженерики



Vitaly [4:54 PM]
ага, спс, на хабре тоже нашел
действительно неочевидные


Vitaly [5:01 PM]
Знатоки Hibernate, хелп
есть реализация JPA через Hibernate и Spring
есть EntityManager

Vitaly [5:03 PM]
uploaded this image: image.png 


Vitaly [5:04 PM]
ставлю точку дебага, чтобы посмотреть что внутри EntityManager:

Vitaly [5:05 PM]
uploaded this image: image.png 


Vitaly [5:06 PM]
т.е. некая реализация FactoryBean, что и следовало ожидать, оно определено в xml
собственно вопрос - в самом классе Local...EFean - нет реализаций методов EntityManager, для примера смотрим метод persist()

Vitaly [5:10 PM]
uploaded this image: image.png 


Vitaly [5:10 PM]
как так происходит, что за магия?
и в списке классов, имплементирующих EntityManager не видно бина LocalContainerEntityManagerFactoryBean

Vitaly [5:13 PM]
uploaded this image: image.png 


Grigory Kislin [12:28 PM]
@Vitaly как у нас будет hibrnate - мы немножко это подебажим
в конце это все приходит к сессиям в реализации хибернайта (edited)

tema.emelyan [10:19 AM]
joined #flooding.


Vitaly [9:06 PM]
Всем привет, кто что знает про потокобезопасность int? Как-то спрашивали на собесе такое, потом гуглил, попадала пара статей - все скаляры меньше 4 байт записываются в одну операцию (что-то типа атомик), больше 4 - записываются в размер/4 байта прохода, и потоконебезопасны. Вопрос - насколько это реально применимо? Я так понимаю, можно byte/short/int писать без volatile? (edited)

Ma3stro [9:32 PM]
Atomic типы. Для инт AtomicInteger, все операции атомарные, загугли


Vitaly [Jun 15th at 9:33 PM]
in #flooding
обычный инт - атомик?


14 replies
vch [4 days ago]
1 и та же переменная хранится в нескольких местах - в памяти, в кэше 1 уровня (который у каждого ядра процессора свой), в кэшах 2 и 3 уровня. Процессор атомарно изменит переменную в своём кэше 1 уровня, но другие ядра об этом не узнают и будут какое-то время работать с устаревшими данными.


Vitaly [4 days ago]
я тоже так думал :slightly_smiling_face:


Vitaly [4 days ago]
думал - либо volatile, либо никак


vch [4 days ago]
может тут путаница в понятиях получилась? Атомарность присвоения означает, что если в переменной был 0, а мы присвоили 10000, то оно произойдёт сразу, а не по частям - т.е. другие потоки будут видеть либо 0, либо 10000, а не какие-нибудь иные промежуточные значения. Но - атомарность присвоения не гарантирует, что другие потоки немедленно увидят новое значение.


Vitaly [4 days ago]
не, там как раз по поводу записи, там в #flood кинул скрины


Vitaly [4 days ago]
оно отлично от обычного понятия потокбезопасности


vch [4 days ago]
Ну, это немного сомнительный аргумент - неизвестно чья статья. Найти бы точное указание в спецификации...


Vitaly [4 days ago]
по сути проблема возникает когда один поток пишет - и много потоков читает, например. Получается - он начинает писать лонг, он не влезает в 4 байта, записал первый байт, и тут же его читает второй поток - ссылка то на переменную есть у него, и хватает не то... как я понимаю


vch [4 days ago]
Ты опять про атомарность присвоения говоришь. А я про другое - про видимость для других потоков нового значения. Даже просто логически если подумать - есть множество последовательных вычислений. Если бы после каждого присвоения кэш сбрасывался в память - это было бы очень медленно.


Vitaly [4 days ago]
я тебя понимаю, и я  о том же


Vitaly [4 days ago]
https://stackoverflow.com/questions/3449790/java-atomics-operations
Stack Overflow
java atomics operations
Is correct to divide the following statements: int v = ++j; as: read j value (atomic); increment by 1 the value read (NON atomic possibly interference by other thread); write the adding result t...
 


Vitaly [4 days ago]
тоже рядом, но не совсем то


Vitaly [4 days ago]
но просто даже в разрезе атомарности присвоения - наверное должны ж быть у всего этого цели и методы работы?


vch [4 days ago]
единственное что я вижу для использования - это что будет видно либо старое значение, либо новое, но не что-то совсем новое. Есть случаи, когда это допустимо в логике приложения. (edited)


Vitaly [9:34 PM]
я не про AtomicInteger, самый обычный int

Ma3stro [9:34 PM]
Нет, обычный непотокобезопасен. Операция i++ вообще выполняется в несколького шагов, если из разных нитей дергать, то будут проблемы уж точно

Vitaly [9:35 PM]
так вот про это и вопрос
i++  - да, но операции чтения/записи в int - якобы безопасны
меня это мучает
ну вот смотрите, народ

Vitaly [9:36 PM]
uploaded this image: image.png 


Vitaly [9:43 PM]
uploaded this image: image.png 


Vitaly [9:44 PM]
оно по кускам везде гуглится, это явно происходит от JVM, но пока не нашел логического объяснения и применения
а тим лид с коварным видом спрашивал :grin:

Grigory Kislin [11:09 PM]
@Vitaly
1. https://dzone.com/articles/longdouble-are-not-atomic-in-java
2. про канкаренси нужно думать только при одновременном доступе нескольких потоком к одним объектам
про конкуренси еще можно посмотрет открытое занятие к masterjava (edited)
dzone.com
Long and Double Values Are Not Atomic in Java - DZone Java
In Java 64-bit, long and double values were treated as two 32-bit values. That means, a 64-bit write operation is basically performed as two separate 32-bit operations.
https://dz2cdn3.dzone.com/storage/article-thumb/792678-thumb.jpg

Stanislav [11:41 PM]
uploaded this image: Screenshot_20180616-024027_ReadEra.jpg 


Stanislav [11:44 PM]
uploaded this file 
JavaConcurrencyInPractice_2010.pdf
3 MB PDF


LeoJames [1:18 AM]
uploaded this image: @Макс Куркудюк 


LeoJames [1:18 AM]
uploaded this image: 2.png 


LeoJames [1:21 AM]
@Макс Куркудюк Гляди, Максимка, как надо людей нае** кхм, дезинформировать. Раз в полгода изображаем видимость работы, проплачиваем рекламу и на фриланс платформах нанимаем людей для комментов, делаем суперм-пупер-мега акцию с блекджеком и скидками, впариваем лоху годовые подписки, которые он выбросит через неделю - повторяем еще через полгода.
Специально для тебя заморочился:grin:
Это я еще так удачно попал, там есть счастливые обладатели годовых подписок с 0 уровнем. Сейчас ситуация не изменилась - разве что комменты потерли, а мой фейковый аккаунт с милейшим вопросом "какого рожна комментаторы больше не заходили на ресурс" потерли через 2 часа с 3х недельным баном (edited)

LeoJames [1:26 AM]
uploaded this image: 3.png 


Tanya [1:30 AM]
на счет проблем с оплатой и бурной радосью - это регулярно, и пластинка за 3 года не поменялась
но в 2015 я покупала на год, т.к. годовая 100 была (по сути безлимитная), а мес по 30 (edited)

LeoJames [1:32 AM]
Ну надо же изобразить дикое желание покупки и доброго дядю модера, который всегда придет на помощь

LeoJames [1:33 AM]
uploaded this image: 4.png 


LeoJames [1:34 AM]
Эти "в разработке" еще лет 5 позволят доить наивных

Макс Куркудюк [7:22 AM]
Ну так, в коментарях я також помічав людей, які не пройшли пару перших рівнів і вже дуже розхвалювали JR...
Але далі такі люди відсіялись і частіше всього писали корисну інформацію про матеріал та хороші посилання..
Тож загалом, там є достатьньо недоліків, які ніхто не хоче виправляти, але і плюси теж є.
Мені сподобався формат навчання у вигляді квесту. Це додавало азарту)
На рахунок "в розробці" недавно дійшов схожої думки. Чув, що "розробка" триває вже не один рік і, схоже, триватиме ще чимало часу)
Ну, я радий, що потрапив (майже, так як ще потрібно пройти стажування і знайти роботу) у дану область сидячи дома)
Надіюсь це швидко окупиться:slightly_smiling_face:

tema.emelyan [7:31 AM]
не ожидал, что гугл транслейт так швидко переводит украинский

tema.emelyan [7:32 AM]
uploaded this image: Screenshot_20180619_143001.png 


tema.emelyan [7:32 AM]
на английский причём ещё лучше


Tanya [7:13 PM]
@LeoJames @stea1th
флудим здесь

stea1th [7:13 PM]
яволь, гнедиге фрау

LeoJames [7:13 PM]
У чела вопрос по проекту, а его гонят во флуд

stea1th [7:14 PM]
кстати да.. из описания ничего не понятно
где, когда, во сколько
нафига скайп?
нужны ли микрофон и наушики?

LeoJames [7:15 PM]
Да ни разу его никто не использовал -_- (edited)

stea1th [7:15 PM]
я ж спецом нашел это г*вно мамонта... а оказывается он никому не нужен

Grigory Kislin [1:56 AM]
@stea1th микрофон и наушники по любому тбе пригодятся. письмо будет


Maksim K [Jun 21st at 11:07 PM]
in #flooding
Всем привет. Объясните как добавиться в общую группу JavaOPs. перехожу по ссылке https://javaops.slack.com/ и ввожу там свой емаил и пароль, которые вводил тут в группе Topjava14. Пишет, что неверно введен емаил или пароль.


1 reply
Grigory Kislin [1 day ago]
из профиля javaops есть кнопка - вступить в Slack javaops


stea1th [11:07 PM]
там надо заново регистрироваться

Maksim K [11:08 PM]
В смысле новый емаил и пароль?

stea1th [11:14 PM]
можешь те же самые задавать

LeoJames [11:14 PM]
Это тест. Нужно взломать

stea1th [11:14 PM]
но надо снова регистрироваться
:slightly_smiling_face:

Maksim K [11:16 PM]
В общем как-то зашел туда. Но не очень все это понятно)
В приложении вошел в одну группу потом в другую и там можно на вкладке переключаться между ними. А вот на сайте еще пока не разобрался как переключаться (тупо открыто две отдельные вкладки)
О. И тут понял как))

Stanislav [11:18 PM]
По началу не превычно, дне 14 пользуюсь слаком и мне нравится

Maksim K [11:18 PM]
Ну да. Надо привыкнуть.
Вообще в первый раз про него слышу
Ниче. Привыкну. Про Джаву тоже раньше ничего не слышал, а сейчас здесь:grin:

Stanislav [11:20 PM]
:)

Maksim K [11:23 PM]
Я так понял каналы нужно вручную все добавлять через поиск. Ибо у меня в javaops только два канала появилось (general и random) после того как добавился в эту группу

Daniel [11:25 PM]
Блин, а как зарегиться-то?) Он пишет "If you have an @javaops.ru email address, you can create an account." Но у меня же нет там почты.

stea1th [11:29 PM]
задавай свою
а мне тут уже нравится

Daniel [11:33 PM]
uploaded this image: 2018-06-21_23-32-17.png 


Daniel [11:33 PM]
Не подскажешь, как в таком случае задать свою почту?)

Maksim K [11:38 PM]
Я подскажу))
В общем, как делал я.
Там где надо было ввести свой мэйл и пароль снизу есть ссылки, мол, если забыл мэйл или пароль. Я перешел по ссылке, типа забыл свой емейл. там короче бла-бла-бла введите емейл и мы вышлем письмо. вводишь свой мейл
приходит письмо. нажимаешь на кнопку подтвердить и переходишь на страничку, где написано, что ты состоишь в топджава и можешь добавиться в джаваопс. нажимаешь добавиться  и там заново регистрируешься
я добавил тоже самое имя, мейл и пароль
и все.
:blush:

stea1th [11:42 PM]
странно... у меня было все проще.. задал емейл, задал пароль.. и вуаля

Maksim K [11:42 PM]
была ли полезна данная информация?
кликните да или нет
:blush:
хорошо, когда проще.

stea1th [11:43 PM]
клик

Maksim K [11:43 PM]
у меня че-то не вышло проще.
зато так вышло, как написал.

stea1th [11:43 PM]
может не на ту ссылку щелкали?

Maksim K [11:43 PM]
главное, что добавил группу))
да хз. везде щелкал))

Grigory Kislin [11:44 PM]
коллеги, зарегистрироваться в общую группу slack javaops можно из личного профиля javaops.ru
кнопка "Присоединиться к общей Slack группе участников и выпускников"
инфа есть в письме участника
зачем чтото изобретать через голову и еще и рекомендовать:) (edited)

Maksim K [11:44 PM]
просто поздно. я устал. голова после работы не варит. поэтому сделал так.
так быстрее
:blush:

Daniel [11:47 PM]
@Maksim K спасибо)

Maksim K [11:50 PM]
пожалуйста)

Maksim K [12:05 AM]
Grigory Kislin, я эту кнопку нажимал. еще вчера. но вчера в эту группу не добавился ибо было поздно. сегодня, когда зашел на slack то сразу автоматом зашло в группу топджава. когда пытался зайти в группу джаваопс, то была проблема как у Daniel. заходил в личный профиль и там еще раз нажимал на кнопку. вылезала следующая надпись:
Спасибо за присоединение общей группе Slack участников и выпускников

Ответ от Slack: already_in_team

НЕ ЗАДАВАЙТЕ вопросов по текущему проекту в эту общую группу!
Решение всех вопросов доступа ТОЛЬКО в личку

stea1th [12:06 AM]
классно
нас столько новеньких, будет интересно делиться опытом :))

Maksim K [12:08 AM]
Правда это ща такая надпись вылазит. А тогда вроде что-то другое было. Не already_in_team, а что-то вроде "уже добавлен"
но при вводе своего емейла и пароля писало, что неправильно ввожу
в общем хз че там было. ща все норм)

Grigory Kislin [12:38 AM]
already_in_team если перевести переводчиком означает, что уже в группе. нужно письмо в спаме поискать

Ramil [12:08 PM]
в раздумьях, стоит ли покупать ревью кода, ведь все равно мы будем разбирать код григория и я увижу свои ошибки

stea1th [12:40 PM]
тебе заранее скажут, что у тебя не так
по моему очень полезно


Max(O)n [2:24 PM]
vaadin 10 вышел, https://expensemanager-pro.demo.vaadin.com/
expensemanager-pro.demo.vaadin.com
Expense Manager
Progressive Web App built using Polymer and Vaadin components
https://vaadin.com/start кому интересно
Vaadin
Starter Packs | Vaadin
Starter packs – Get up and running with ready templates.
https://vaadin.com/images/social-media/vaadinffs-banner.png


Yevhen Maksymovych [4:05 PM]
ребят, подскажите, мне надо с помощью спринг дата массово импортнуть данные в бд. какой сейчас актуальный способ массовой вставки? на спринг.ио какой-то кривой пример, в других местах предлагают автовайрить ентитименеджер, вручную открывать транзакцию в ее рамках делать всю работу. неужели нет ничего в JpaRepository типа bunchSave(Collection<T> items)?

Yevhen Maksymovych [4:16 PM]
ну, т.е. я сделал так, но насколько это корректно?
```@Override
    public void bunchSave(List<Record> records, int batchSize) {
        EntityManager entityManager = entityManagerFactory.createEntityManager();
        EntityTransaction transaction = entityManager.getTransaction();
        try {
            transaction.begin();
            for (int i = 0; i < records.size(); i++) {
                if (i > 0 && i % batchSize == 0) {
                    transaction.commit();
                    transaction.begin();
                    entityManager.clear();
                }
                entityManager.persist(records.get(i));
            }
            transaction.commit();
        } catch (RuntimeException e) {
            if (transaction.isActive()) {
                transaction.rollback();
            }
            throw e;
        } finally {
            entityManager.close();
        }
    }```

tema.emelyan [4:42 PM]
@Yevhen Maksymovych вот так пробовал? я сам не пробовал https://stackoverflow.com/a/35794220/6098646
Stack Overflow
Spring Data JPA: Batch insert for nested entities
I have a test case where I need to persist 100'000 entity instances into the database. The code I'm currently using does this, but it takes up to 40 seconds until all the data is persisted in the

Yevhen Maksymovych [4:52 PM]
попробовал, но тупо прописать эти настройки в entityManagerFactory не помогает, все инсёрты делаются "поштучно"

Victor [5:10 PM]
Create-Retrieve-Update-Delete (CRUD) 
Retrieve вместо read как-то в рифму даже ))))

Stanislav [5:11 PM]
Посмотри на Spring Batch (edited)


Stanislav [Today at 5:12 PM]
in #flooding
http://javainside.ru/primer-ispolzovaniya-spring-batch-3-0-chast-1/
Java Inside
Spring Batch 3.0 - Часть 1: Пример использования - Java Inside
Spring Batch 3.0 – это подпроект Spring Framework, реализующий стандарт JSR-352 для выполнения пакетных заданий. Приступим сразу к делу и покажем на примере для чего это все нужно. Напишем небольшое веб-приложение, которое будет запускать пакетное задание и отображать состояние выполнения клиенту. В нескольких
Sep 9th, 2016 at 3:03 PM
 
 


4 replies
Yevhen Maksymovych [6 hours ago]
спасибо :slightly_smiling_face: вот эту штуку я и имел в виду под "кривой" - слишком много движений для казалось бы простой операции. + там третий спринг батч (уже четвертый есть), я думал, мало ли, может уже в spring-data-jpa что-то такое запихнули, но интуитивное и простое


Stanislav [6 hours ago]
Ну эт навороченое, но за то будет пунктик, что работал :)


Yevhen Maksymovych [6 hours ago]
да прикрутить не проблема, но я ж уже через два дня забуду, как я это сделал :slightly_smiling_face:


Stanislav [6 hours ago]
Сорсы останутся...я всегда вспоминаю по своим, чужие сложнее читать


tema.emelyan [Today at 5:45 PM]
in #flooding
@Yevhen Maksymovych а как ты понимаешь saveAll сохраняет в батчах или нет?


7 replies
Yevhen Maksymovych [6 hours ago]
showSql у jpaVendorAdapter'а включил


tema.emelyan [6 hours ago]
я просто читал, что у мужика вот логи не фурычили, хотя батчи работали


tema.emelyan [6 hours ago]
https://stackoverflow.com/questions/34228044/how-to-enable-batch-inserts-with-hibernate-and-spring-boot
Stack Overflow
How to enable batch inserts with Hibernate and Spring Boot
I want to insert a large number of entities into cross table. To do that, I want to enable hibernate's batch insert option, so that each insert will add not 1, but 20 or 50 rows at a time. I'm try...
 


Yevhen Maksymovych [6 hours ago]
странная штука


Yevhen Maksymovych [6 hours ago]
у меня, похоже, подобная беда


Yevhen Maksymovych [6 hours ago]
но, у меня логи пашут


Yevhen Maksymovych [6 hours ago]
но чисто по разнице по времени, явно saveAll делает это батчами, хотя вывод в консоль совершенно одинаковый


denis [6:01 PM]
@Yevhen Maksymovych есть же  saveAll(Iterable<S> entities) спрингдатовский

tema.emelyan [6:02 PM]
Я теперь запутался, если вызывать вставки внутри одной транзакции, то хоть по одной записи, хоть saveAll работает одинаково - примерно 40 сек на 100_000 записей
вывод в консоль (при меньшем кол-ве записей само собой) одинаковый
если убрать транзакции, то saveAll всё равно около 40 секунд
по одному в цикле - не дождался (сильно медленнее)

Yevhen Maksymovych [6:04 PM]
@denis, @tema.emelyan, спасибо, забил на консоль, главное, импорт заработал быстро :slightly_smiling_face:
а то я уже расстроился, что придётся на всю ночь ставить
70 секунд на 498000 записей

tema.emelyan [6:07 PM]
а сколько колонок у тебя?
полей

Yevhen Maksymovych [6:08 PM]
18

tema.emelyan [6:08 PM]
ssd?

Yevhen Maksymovych [6:08 PM]
причем 70 сек, это с учётом, что он из файлов подсасывает данные, щаз померяю чисто сохранение в бд
да, ссд
ну, я ещё щаз индексов накручу, по факту станет медленнее :slightly_smiling_face:

tema.emelyan [6:09 PM]
ssd кайф

Yevhen Maksymovych [6:13 PM]
ага, уже лет шесть на ссд живу, прямо дискомфорт чувствую, когда приходится на чужом пк работать с хдд
```18:13:11.012 DEBUG ua.dp.rundot.SpringCtxTest.folderImportSaveAll - Parsing time: 5212 ms
18:13:11.013 DEBUG ua.dp.rundot.SpringCtxTest.folderImportSaveAll - Records parsed: 398191
18:14:12.850 DEBUG ua.dp.rundot.SpringCtxTest.folderImportSaveAll - Storing time: 61837 ms```

tema.emelyan [6:15 PM]
щас всё тайное станет явным
:rat: :turtle: :turtle: :turtle: :turtle: (edited)
или не станет =(

Yevhen Maksymovych [6:18 PM]
мм?

tema.emelyan [6:18 PM]
сенсей печатал чота, но видимо передумал :slightly_smiling_face: (edited)
я теперь хочу настроить так, чтобы было батчами, но не получается. получается всё одим махом только

Yevhen Maksymovych [6:19 PM]
а ты STATEMENT_BATCH_SIZE укажи

Grigory Kislin [6:20 PM]
Spring batch  это отдельный фреймворк для выполнения пакетных задач. к bacth встевке в базу отношения не имеет
https://www.google.ru/search?newwindow=1&source=hp&ei=Czc-W-vFE6OE6ASwwKq4BA&q=spring%2Bdata%2Bjpa%2Bbatch%2Binsert&oq=spring%2Bdata%2Bjpa%2Bbatch%2Binsert


Ma3stro [Today at 9:08 PM]
in #flooding
Планирую написать небольшой сайт, куда можно добавлять новости. Правильно ли, что новость со всем ее текстом должна хранится в бд? Не накладно ли, что огромный текст будет там содержаться?
Также думал над тем, что новости не должны хранится в бд, а просто на сервере отдельной html страничкой, но пока даже не представляю, как это реализовать


1 reply
Yevhen Maksymovych [3 hours ago]
не парься. в БД в виде двоичных данных чего только не складывают. твоя текстовая новость для нее - что для слона дробинка

shomnest [3 days ago]
cms drupal тебе в помощь


Yevhen Maksymovych [9:51 PM]
а что случилось с versioneye? он как-то намертво лежит. есть какой-то другой сервис, который умеет актуальность зависимостей отслеживать?

Grigory Kislin [11:08 PM]
@Yevhen Maksymovych
он умер. автор закрыл (edited)


Victor [11:05 PM]
Пишу метод, возврат написал Spring вместо String и сижу смотрю на него. А Идея красным закрасила.... Думаю: с чего это Идея String красным красит.....:smiley:
